# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–≤—è–∑—ã–≤–∞–Ω–∏—é –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

–í —Å–∏—Å—Ç–µ–º–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
- **Client** ‚Äî –±–∏–∑–Ω–µ—Å-—Å—É—â–Ω–æ—Å—Ç—å (–∫–æ–º–ø–∞–Ω–∏—è, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è)
- **User** ‚Äî –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:

1. **Client –º–æ–∂–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –±–µ–∑ User** ‚Äî –∞–¥–º–∏–Ω —Å–æ–∑–¥–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –∑–∞—Ä–∞–Ω–µ–µ
2. **User –≤—Å–µ–≥–¥–∞ —Å–≤—è–∑–∞–Ω —Å Client** ‚Äî –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ª–∏–±–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–ª–∏–µ–Ω—Ç, –ª–∏–±–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π
3. **–ü—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ phone –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≤—è–∑—ã–≤–∞—é—Ç—Å—è** ‚Äî –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç —Å —Ç–∞–∫–∏–º phone —É–∂–µ –µ—Å—Ç—å, –Ω–æ–≤—ã–π User —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å –Ω–∏–º

---

## –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ê–¥–º–∏–Ω —Å–æ–∑–¥–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ ‚Üí –ö–ª–∏–µ–Ω—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è

### –®–∞–≥ 1: –ê–¥–º–∏–Ω —Å–æ–∑–¥–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞

```typescript
// POST /api/clients
{
  "name": "–û–û–û –ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å",
  "fullName": "–û–±—â–µ—Å—Ç–≤–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é –ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å",
  "phone": "+380501234567",
  "address": "–≥. –ö–∏–µ–≤, —É–ª. –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è, 1",
  "priceAccessId": 2,
  "warehouseAccessId": 1
}
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚úÖ –°–æ–∑–¥–∞–Ω Client –±–µ–∑ User
- ‚úÖ –ê–¥–º–∏–Ω –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–∫–∞–∑—ã –¥–ª—è —ç—Ç–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- ‚úÖ Client –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º —Ü–µ–Ω–∞–º –∏ —Å–∫–ª–∞–¥—É

### –®–∞–≥ 2: –ö–ª–∏–µ–Ω—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ

```typescript
// POST /api/auth/register
{
  "email": "info@autoservice.com",
  "password": "secure123",
  "name": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
  "phone": "+380501234567",  // üëà –°–æ–≤–ø–∞–¥–∞–µ—Ç —Å phone –∫–ª–∏–µ–Ω—Ç–∞!
  "address": "–≥. –ö–∏–µ–≤, —É–ª. –ì–ª–∞–≤–Ω–∞—è, 5"
}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**

1. –°–∏—Å—Ç–µ–º–∞ –∏—â–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ Client –ø–æ phone
2. –ù–∞—Ö–æ–¥–∏—Ç "–û–û–û –ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å" —Å —ç—Ç–∏–º phone
3. **–ù–ï —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞**
4. –°–æ–∑–¥–∞–µ—Ç User, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –Ω–∞–π–¥–µ–Ω–Ω—ã–º Client
5. –û–±–Ω–æ–≤–ª—è–µ—Ç address –∫–ª–∏–µ–Ω—Ç–∞ (–µ—Å–ª–∏ –±—ã–ª —É–∫–∞–∑–∞–Ω)
6. **–°–æ—Ö—Ä–∞–Ω—è–µ—Ç name –∏ fullName –∫–ª–∏–µ–Ω—Ç–∞** (–Ω–µ –º–µ–Ω—è–µ—Ç –Ω–∞ "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤")

–†–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚úÖ User "info@autoservice.com" —Å–≤—è–∑–∞–Ω —Å Client "–û–û–û –ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å"
- ‚úÖ –í—Å–µ –∑–∞–∫–∞–∑—ã, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∞–¥–º–∏–Ω–æ–º –¥–ª—è —ç—Ç–æ–≥–æ Client, —Ç–µ–ø–µ—Ä—å –≤–∏–¥–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- ‚úÖ –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Client (—Ü–µ–Ω—ã, —Å–∫–ª–∞–¥)
- ‚úÖ –ë–∏–∑–Ω–µ—Å-–Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Å—Ç–∞–µ—Ç—Å—è "–û–û–û –ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å"

---

## –°—Ü–µ–Ω–∞—Ä–∏–π 2: –û–±—ã—á–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (–±–µ–∑ –ø—Ä–µ–¥—Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞)

```typescript
// POST /api/auth/register
{
  "email": "new@example.com",
  "password": "secure123",
  "name": "–ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞",
  "phone": "+380509876543",  // üëà –ù–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ —Å —ç—Ç–∏–º phone –Ω–µ—Ç
}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**

1. –°–∏—Å—Ç–µ–º–∞ –∏—â–µ—Ç Client –ø–æ phone ‚Äî –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç
2. –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–≥–æ Client:
   ```json
   {
     "name": "–ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞",
     "fullName": "–ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞",
     "phone": "+380509876543"
   }
   ```
3. –°–æ–∑–¥–∞–µ—Ç User, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –Ω–æ–≤—ã–º Client

–†–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚úÖ –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π Client –∏ User
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–∫–∞–∑—ã

---

## –°—Ü–µ–Ω–∞—Ä–∏–π 3: –†—É—á–Ω–æ–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ (–∞–¥–º–∏–Ω)

–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω, –Ω–æ –∞–¥–º–∏–Ω —Ö–æ—á–µ—Ç —Å–≤—è–∑–∞—Ç—å –µ–≥–æ —Å –¥—Ä—É–≥–∏–º –∫–ª–∏–µ–Ω—Ç–æ–º:

```typescript
// POST /api/users/{userId}/link-client
{
  "clientId": "client-id-here"
}
```

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- ‚ùå –ù–µ–ª—å–∑—è —Å–≤—è–∑–∞—Ç—å, –µ—Å–ª–∏ —É —Ç–µ–∫—É—â–µ–≥–æ Client –µ—Å—Ç—å –∑–∞–∫–∞–∑—ã
- ‚ùå –ù–µ–ª—å–∑—è —Å–≤—è–∑–∞—Ç—å —Å Client, –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ —Å–≤—è–∑–∞–Ω —Å –¥—Ä—É–≥–∏–º User
- ‚úÖ –ú–æ–∂–Ω–æ —Å–≤—è–∑–∞—Ç—å —Å "—Å–≤–æ–±–æ–¥–Ω—ã–º" Client (–±–µ–∑ User)

---

## –°—Ü–µ–Ω–∞—Ä–∏–π 4: –û—Ç–≤—è–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞

```typescript
// DELETE /api/users/{userId}/link-client
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –ø—É—Å—Ç–æ–π Client
2. User —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å –Ω–æ–≤—ã–º Client
3. –°—Ç–∞—Ä—ã–π Client —É–¥–∞–ª—è–µ—Ç—Å—è (–µ—Å–ª–∏ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤)

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- ‚ùå –ù–µ–ª—å–∑—è –æ—Ç–≤—è–∑–∞—Ç—å, –µ—Å–ª–∏ –µ—Å—Ç—å –∑–∞–∫–∞–∑—ã

---

## API Endpoints

### –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ (–∞–¥–º–∏–Ω)
```http
POST /api/clients
Authorization: Bearer <admin-token>

{
  "name": "–ö—Ä–∞—Ç–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ",
  "fullName": "–ü–æ–ª–Ω–æ–µ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ",
  "phone": "+380501234567",
  "address": "–ê–¥—Ä–µ—Å",
  "priceAccessId": 2,
  "warehouseAccessId": 1
}
```

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```http
POST /api/auth/register

{
  "email": "user@example.com",
  "password": "password",
  "name": "–ò–º—è",
  "phone": "+380501234567"
}
```

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç Client –ø–æ phone –∏–ª–∏ —Å–æ–∑–¥–∞—Å—Ç –Ω–æ–≤–æ–≥–æ.

### –°–≤—è–∑–∞—Ç—å User —Å Client (–∞–¥–º–∏–Ω)
```http
POST /api/users/{userId}/link-client
Authorization: Bearer <admin-token>

{
  "clientId": "client-id"
}
```

### –û—Ç–≤—è–∑–∞—Ç—å User –æ—Ç Client (–∞–¥–º–∏–Ω)
```http
DELETE /api/users/{userId}/link-client
Authorization: Bearer <admin-token>
```

---

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å**: –ê–¥–º–∏–Ω –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤ –∑–∞—Ä–∞–Ω–µ–µ  
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**: –ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–ª–∏–µ–Ω—Ç–æ–º  
‚úÖ **–ò—Å—Ç–æ—Ä–∏—è**: –í—Å–µ –∑–∞–∫–∞–∑—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞  
‚úÖ **–î–∞–Ω–Ω—ã–µ**: –ë–∏–∑–Ω–µ—Å-–¥–∞–Ω–Ω—ã–µ (–Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏) –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è  
‚úÖ **–ö–æ–Ω—Ç—Ä–æ–ª—å**: –ê–¥–º–∏–Ω –º–æ–∂–µ—Ç –≤—Ä—É—á–Ω—É—é —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–≤—è–∑—è–º–∏  

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ

### –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```typescript
const user = await db.user.findUnique({
  where: { email: session.user.email },
  include: {
    client: {
      include: {
        priceAccess: true,
        warehouseAccess: true,
      }
    }
  }
});

console.log(user.client.name); // "–û–û–û –ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å"
console.log(user.client.priceAccess.name); // "–û–ø—Ç–æ–≤–∞—è —Ü–µ–Ω–∞"
```

### –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞

```typescript
const order = await db.orders.create({
  data: {
    client_id: user.clientId, // –ò—Å–ø–æ–ª—å–∑—É–µ–º clientId –∏–∑ User
    orderStatus_id: 1,
    // ...
  }
});
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å–≤—è–∑–∞–Ω –ª–∏ –∫–ª–∏–µ–Ω—Ç —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º

```typescript
const client = await db.clients.findUnique({
  where: { id: clientId },
  include: { user: true }
});

if (client.user) {
  console.log(`–ö–ª–∏–µ–Ω—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω: ${client.user.email}`);
} else {
  console.log('–ö–ª–∏–µ–Ω—Ç –µ—â–µ –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω');
}
```

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚ö†Ô∏è –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã –º–æ–≥—É—Ç –≤—Ä—É—á–Ω—É—é —Å–≤—è–∑—ã–≤–∞—Ç—å/–æ—Ç–≤—è–∑—ã–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤
- ‚ö†Ô∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –≤–∏–¥–µ—Ç—å —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ —Å–≤–æ–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- ‚ö†Ô∏è –ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å/–∏–∑–º–µ–Ω–∏—Ç—å —Å–≤—è–∑—å, –µ—Å–ª–∏ –µ—Å—Ç—å –∑–∞–∫–∞–∑—ã
- ‚ö†Ô∏è –ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ phone –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º (–æ–¥–∏–Ω Client = –æ–¥–∏–Ω phone)

